---
title: "Regress√£o Linear M√∫ltipla - Exemplo Wage"
author: "Julio Hsu, Guilherme Alberto Dutra Camelo, Fernando Souto Lima"
date: "`r Sys.Date()`"
format: pdf
documentclass: scrartcl
classoption:
  - DIV=11
  - numbers=noendperiod
papersize: letter
header-includes:
  - '\KOMAoption{captions}{tableheading}'
block-headings: true
lang: pt
# bibliography:
#   - 00_Refs/refs.bib
---

```{r Setup}
#| echo: true

# Setup para o relat√≥rio Quarto

knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)

```


# Introdu√ß√£o

O objetivo deste relat√≥rio √© desenvolver um modelo de regress√£o linear m√∫ltipla para analisar a rela√ß√£o entre o sal√°rio e as caracter√≠sticas como idade, estado civil, ra√ßa, n√≠vel de educa√ß√£o, entre outras, de 3000 empregados masculinos na regi√£o do Atl√¢ntico.

Todas as an√°lises s√£o realizadas com base no conjunto de dados "Wage", editado manualmente por Steve Miller, da Inquidia Consulting (anteriormente Open BI), a partir do suplemento de mar√ßo de 2011 da Pesquisa Atual de Popula√ß√£o.

Fonte: `https://www.re3data.org/repository/r3d100011860`


# Os Dados

Com a inser√ß√£o da base de dados mencionado acima, podemos observar que temos um rel√°torio de 3000 ind√≠viduos representado por 'Rows' e suas respectivas 11 caracter√≠sticas representado por 'Columns', tal como:

```{r}
library(ISLR)
library(dplyr)

glimpse(Wage)
```
Al√©m disso, ao analisar as caracter√≠sticas ou vari√°veis correlacionadas √† vari√°vel resposta "wage", temos os seguintes dados para cada indiv√≠duo:

-   `year`: ano em que os dados foram relatados (n√∫mero inteiro);

-   `age`: idade do empregado (n√∫mero inteiro);

-   `maritl`: estado civil (categoria): 1.Solteiro 2.Casado 3.Vi√∫vo 4.Divorciado 5.Separado;

-   `race`: ra√ßa do empregado (categoria): 1.Branco 2.Negro 3.Asi√°tico 4.Outros;

-   `education`: n√≠vel educacional (categoria): 1.Abaixo do ensino m√©dio 2.Ensino m√©dio completo 3.Ensino superior em andamento 4.Gradua√ß√£o/Bacharelado 5.P√≥s-gradua√ß√£o;

-   `region`: regi√£o do pa√≠s (apenas Meio-Atl√¢ntico);

-   `jobclass`: tipo de emprego (categoria): 1.Industrial 2.Informa√ß√£o;

-   `health`: n√≠vel de sa√∫de do trabalhador (categoria): 1.Sa√∫de intermedi√°ria ou inferior 2.Sa√∫de superior ou excelente;

-   `health_ins`: possui plano de sa√∫de (categoria): 1.Sim 2.N√£o;

-   `logwage`: logaritmo do sal√°rio do trabalhador (n√∫mero ponto flutuante);

-   `wage`: sal√°rio bruto do trabalhador (n√∫mero ponto flutuante).


# An√°lise Explorat√≥ria dos Dados

Em seguida, com a an√°lise das vari√°veis acima, podemos nos aprofundar mais para filtrar ou melhorar a base de dados fornecida, visando identificar poss√≠veis aus√™ncias de dados, outliers, etc.

```{r}
library(skimr)
skim(Wage)
```

Analisando com o resumo de dados acima, podemos notar que a base de dados √© divida em 2 dataframes: 1. dados categ√≥ricos (7 vari√°veis) 2. dados num√©ricos (4 vari√°veis). Nenhum deles apresenta valores perdidos "n_missing". Logo, aproveitando essas vari√°veis podemos analisar suas respectivas correla√ß√µes nesta conjuntura de dados...


# An√°lise de Correla√ß√£o (Gr√°fico & Tabela)

```{r}
library(corrplot)

num_col <- Wage[sapply(Wage, is.numeric)]

corr <- cor(num_col, use = 'pairwise.complete.obs')

corrplot(corr, method = 'circle')
```
Com o gr√°fico da correla√ß√£o das vari√°veis num√©ricas, podemos notar em que existe muita pouca correla√ß√£o entre as vari√°veis indenpendentes. Por√©m, especialmente na vari√°vel "logwage", podemos notar uma forte correla√ß√£o com a vari√°vel "wage", ou seja, a vari√°vel resposta dos nossos dados.

```{r}
library(vcd)

categorical_columns <- Wage[sapply(Wage, is.factor)]

association_results <- data.frame(
  Var1 = character(), 
  Var2 = character(), 
  CramerV = numeric(),
  stringsAsFactors = FALSE
)

for (i in 1:(ncol(categorical_columns) - 1)) {
  for (j in (i + 1):ncol(categorical_columns)) {
    contingency_table <- table(categorical_columns[[i]], categorical_columns[[j]])  # Corre√ß√£o aqui
    cramer_v <- assocstats(contingency_table)$cramer
    association_results <- rbind(
      association_results, 
      data.frame(
        Var1 = colnames(categorical_columns)[i],
        Var2 = colnames(categorical_columns)[j],
        CramerV = cramer_v
      )
    )
  }
}

association_results
```
Em seguida, nesta tabela de correla√ß√£o entre as vari√°veis categ√≥ricas independentes, podemos visualizar tamb√©m a fraca correla√ß√£o das vari√°veis por meio dos valores de correla√ß√£o calculados.

Por fim, com base do an√°lise do gr√°fico (vari√°veis num√©ricas) e da tabela (vari√°veis categ√≥ricas), podemos concluir que a correla√ß√£o existente entre as vari√°veis √© m√≠nima. Extraindo sinais sobre as vari√°veis tal como...

1. A vari√°vel dependente √© "wage".
2. N√£o apresenta multicolinearidade para vari√°vel "year".
3. N√£o apresenta multincolinearidade para vari√°vel "age".

Al√©m disso, as correla√ß√µes entre as vari√°veis categ√≥ricas independentes √© m√≠nima, logo, podemos inferir uma baixa exist√™ncia da multicolinearidade atrav√©s do Fator de Infla√ß√£o da Vari√¢ncia (VIF) abaixo.


# An√°lise da Multicolinearidade (VIF)

```{r}
sapply(Wage[, sapply(Wage, is.factor)], levels)
```

```{r}
table(Wage$year)
table(Wage$age)
table(Wage$maritl)
table(Wage$race)
table(Wage$education)
table(Wage$region)
table(Wage$jobclass)
table(Wage$health)
table(Wage$health_ins)
```

# Modelo

```{r}
library(car)
dados_filtrados <- Wage %>% select(-c(region, logwage))
modelo <- lm(wage ~ ., data = dados_filtrados)
vif(modelo)
```
Logo, podemos concluir que todas as vari√°veis realmente n√£o possuem uma correla√ß√£o forte, j√° que seus respectivos
valores de VIF apresentaram valores abaixo de 10. Portanto, fica evidente que as vari√°veis independentes, explicam
separadamente a vari√°vel resposta/dependente "wage" sem interfer√™ncia das outras.


```{r}
summary(modelo)
```
Nesse modelo temos um R-quadrado de 0.3361, o que indica que aproximadamente 33.61% da varia√ß√£o do sal√°rio √©
explicada pelas vari√°veis inclu√≠das. Com esse modelo tamb√©m podemos tirar algumas conclus√µes como:

- A vari√°vel "health_ins2. No" tem um efeito negativo significativo no sal√°rio (-17.51, p < 2e-16).
- A vari√°vel "education5. Advanced Degree" t√™m um efeito positivo significativo no sal√°rio (53.95, p < 2e-16).
```{r}

step(modelo)

```

```{r}

plot(modelo)

```

Seguindo as observa√ß√µes dos gr√°ficos de an√°lise das rela√ß√µes entre vari√°veis e suas respectivas dispers√µes e padroniza√ß√£o dos res√≠duos, podemos concluir que nosso modelo de regress√£o linear ainda precisa de ajuste, devido a falta da uniformidade/linearidade da distribui√ß√£o do nosso res√≠duos.

Primeiramente, dever√≠amos testar cada vari√°vel do nosso modelo para inferir sua respectiva influ√™ncia no modelo.

```{r}

modelo1 <- update(modelo, ~. -year)

summary(modelo1)

```

```{r}

modelo1 <- update(modelo, ~. -age)

summary(modelo1)

```

```{r}

modelo1 <- update(modelo, ~. -maritl)

summary(modelo1)

```

```{r}

modelo1 <- update(modelo, ~. -race)

summary(modelo1)

```

```{r}

modelo1 <- update(modelo, ~. -education)

summary(modelo1)

```

- Ao remover a vari√°vel education podemos ver um impacto muito significativo no modelo. O R-quadrado caiu de 33.61%
para 20.55%, o que indica que a vari√°vel education tem um grande correla√ß√£o com a nossa vari√°vel em estudo.

```{r}

modelo1 <- update(modelo, ~. -jobclass)

summary(modelo1)

```

```{r}

modelo1 <- update(modelo, ~. -health)

summary(modelo1)

```

Depois de ter analisado a influ√™ncia de cada um das vari√°veis do nosso modelo, podemos concluir que algumas delas t√™m pouca influ√™ncia sobre o modelo, ou melhor uma influ√™ncia negativa diminuindo o "R-squared". 

Por conseguinte, dever√≠amos olhar e redefinir o nosso caso base, onde definimos o par√¢metro do nosso modelo inicialmente, excluindo algumas vari√°veis que n√£o explicam profundamente e de forma un√≠ssona sobre a vari√°vel resposta tal como race, jobclass, etc.

Al√©m disso, podemos mudar o olhar da nossa vari√°vel de resposta "wage" para o "logwage", desde que percebemos uma n√£o-linearidade dos pontos de dados residuais que provavelmente pode ser causado pela dispers√£o do intervalo da vari√°vel de resposta.

# Modelo 2

```{r}
dados_filtrados <- Wage %>% select(-c(region, jobclass, race, health_ins, wage))
modelo2 <- lm(logwage ~ ., data = dados_filtrados)
summary(modelo2)
```

Com esse segundo modelo podemos tirar algumas conclus√µes:

- O R-quadrado teve uma pequena queda para 30.84%, por√©m o erro padr√£o residual √© de 0.2925, o que mostra que o
modelo tem uma precis√£o razo√°vel para os dados transformados em log.
- O coeficiente de year (0.01171) indica que, para cada ano adicional, espera-se um aumento de aproximadamente 1.17%
no sal√°rio, assumindo que as demais vari√°veis s√£o constantes, o que √© altamente significativo com um valor p muito
baixo (9.74e-06).
- Ter um grau avan√ßado de educa√ß√£o (education5. Advanced Degree) resulta em um aumento esperado de aproximadamente
51.06% no log do sal√°rio, que se traduz em um efeito substancial no sal√°rio real.

```{r}
step(modelo2, direction='backward')
```

# Pressupostos do MRLM

```{r}
plot(modelo2)
```

Diante do que foi ajustado com as vari√°veis, descartando vari√°veis que impactam negativamente o modelo, podemos
observar que foi obtido uma uniformidade dos nossos res√≠duos que anteriormente estavam formando uma par√°bola.

Al√©m disso, √© not√≥rio que existe alguns outliers na nossa base de dados. Logo, o sugerido para aprimorar o modelo
seria a remo√ß√£o dos outliers conforme mostrado nos passos abaixo.


```{r}
outliers <- outlierTest(modelo2)

outliers
```

A partir dos dados acima podemos notar alguns outliers, os valores identificados na tabela s√£o aqueles com valores de
res√≠duos padronizados (rstudent) extremos e p-valores ajustados por Bonferroni menores que 0.05. Ent√£o o pr√≥ximo
passo √© remover eles dos nossos dados.

```{r}

outliers_indices <- c(7434, 155433, 156036, 159513, 86679, 160130, 160269, 228764, 452906, 2192,2822, 500, 359)

wage_sem_outliers <- Wage %>% slice(-outliers_indices)

glimpse(wage_sem_outliers)

# checkar se ainda existe outliers ou n√£o
any(outliers_indices %in% rownames(wage_sem_outliers))
```
# Modelo 3

```{r}

dados_filtrados <- wage_sem_outliers %>% select(-c(region, jobclass, race, health_ins, wage))
modelo3 <- lm(logwage ~ ., data = dados_filtrados)
summary(modelo3)

```
Com os pequenos ajustes acima percemos que o 'R-squared' foi aprimorado (al√©m do erro residual ter diminuido para
0.289), ent√£o o sugerido seria continuar com a elimina√ß√£o das vari√°veis que comprometem as seguintes caracter√≠sticas:
Linearidade, Independ√™ncia dos Erros, Homoscedasticidade, Normalidade dos Erros, Aus√™ncia de Multicolinearidade,
Independ√™ncia das Observa√ß√µes;

As observa√ß√µes no conjunto de dados devem ser independentes umas das outras. Isso √© especialmente importante em dados
de s√©ries temporais ou dados agrupados.

# Interpreta√ß√µes do modelo selecionado

```{r}
library(report)
report(modelo3)
```
Fizemos uma an√°lise usando um modelo de regress√£o linear (estimado por M√≠nimos Quadrados Ordin√°rios - OLS) para
prever o logaritmo do sal√°rio (logwage) com base nas vari√°veis: ano (year), idade (age), estado civil (maritl), n√≠vel
de escolaridade (education) e sa√∫de (health). O modelo mostra que essas vari√°veis explicam uma parte significativa da
varia√ß√£o no logaritmo do sal√°rio (R¬≤ = 0,32), o que significa que cerca de 32% da varia√ß√£o nos sal√°rios pode ser
atribu√≠da a essas vari√°veis. A estat√≠stica F do modelo √© alta (F(11, 2984) = 126,05, p < 0,001), indicando que o
modelo √© estatisticamente significativo.

Interpreta√ß√£o dos Resultados do Modelo:
Intercepto: O intercepto do modelo √© de -19,11, o que representa o valor estimado do logaritmo do sal√°rio quando
todas as vari√°veis independentes s√£o iguais a zero. Isso √© apenas uma refer√™ncia e n√£o √© interpret√°vel na pr√°tica,
pois uma idade de 0, estado civil "nunca casado", escolaridade "menos que o ensino m√©dio" e sa√∫de "ruim" n√£o
representam uma situa√ß√£o realista.

Ano (year): A cada ano adicional, o logaritmo do sal√°rio aumenta em m√©dia 0,01 (ou seja, cerca de 1% quando
transformado de logar√≠tmico para o valor original). Isso indica uma tend√™ncia positiva nos sal√°rios ao longo do
tempo. O efeito √© estatisticamente significativo (p < 0,001).

Idade (age): A cada ano a mais de idade, o logaritmo do sal√°rio tamb√©m aumenta em m√©dia 0,0035, indicando que pessoas
mais velhas tendem a ganhar sal√°rios ligeiramente mais altos. Esse efeito tamb√©m √© estatisticamente significativo (p
< 0,001).

Estado Civil (maritl):

- Casado: Pessoas casadas tendem a ganhar em m√©dia 0,18 a mais no logaritmo do sal√°rio em compara√ß√£o com aquelas que
nunca se casaram, o que √© um efeito consider√°vel e estatisticamente significativo (p < 0,001).
- Vi√∫vo: N√£o h√° efeito significativo no sal√°rio para vi√∫vos (p = 0,456).
- Divorciado: O efeito √© positivo (0,07) e estatisticamente significativo (p = 0,002), sugerindo que divorciados
ganham mais em compara√ß√£o com os que nunca se casaram, mas o efeito √© menor em rela√ß√£o aos casados.
- Separado: O efeito √© positivo e significativo (0,13, p = 0,001), indicando um aumento consider√°vel no sal√°rio em
rela√ß√£o a quem nunca se casou.

Educa√ß√£o (education):

Cada n√≠vel de escolaridade adicional tem um efeito positivo significativo no logaritmo do sal√°rio:
- Ensino M√©dio: Aumento de 0,12, significativo (p < 0,001).
- Algum Ensino Superior: Aumento de 0,24, significativo (p < 0,001).
- Gradua√ß√£o: Aumento de 0,35, significativo (p < 0,001).
- P√≥s-Gradua√ß√£o: Aumento de 0,51, significativo (p < 0,001). 
Isso mostra que quanto mais alto o n√≠vel de
escolaridade, maior √© o sal√°rio, com os p√≥s-graduados tendo o maior impacto.

Sa√∫de (health):

Aqueles com sa√∫de "muito boa" ou melhor ganham em m√©dia 0,07 a mais no logaritmo do sal√°rio em compara√ß√£o com aqueles
com sa√∫de "boa" ou pior. Este efeito √© estatisticamente significativo (p < 0,001), indicando que uma melhor sa√∫de
est√° associada a sal√°rios mais altos.

Conclus√£o Pr√°tica:
Esses resultados indicam que fatores como a escolaridade, o estado civil e a sa√∫de t√™m impactos positivos e
significativos nos sal√°rios. Especificamente, o aumento da escolaridade e a melhoria na sa√∫de s√£o associados a
sal√°rios mais altos, enquanto o estado civil de ser casado tamb√©m est√° fortemente associado a ganhos maiores. Esses
insights podem ser valiosos para formuladores de pol√≠ticas e para pessoas que buscam melhorar sua posi√ß√£o no mercado
de trabalho, enfatizando a import√¢ncia da educa√ß√£o e da sa√∫de.

# Previs√µes

Um breve resumo sobre os dados observados:

```{r}
summary(Wage)
```
E agora vamos criar um dataframe para calcular a estima√ß√£o pontual e intervalar para dois valores m√©dios da vari√°vel resposta, a explicativa do nosso modelo...

```{r}

novos_dados_media <- data.frame(
  year = c(2007, 2008),
  age = c(30, 45),
  maritl = factor(c("1. Never Married", "2. Married"), 
                  levels = c("1. Never Married", "2. Married", "3. Widowed", "4. Divorced", "5. Separated")),
  education = factor(c("2. HS Grad", "3. Some College"), 
                     levels = c("1. < HS Grad", "2. HS Grad", "3. Some College", "4. College Grad", "5. Advanced Degree")),
  health = factor(c("1. <=Good", "2. >=Very Good"), 
                  levels = c("1. <=Good", "2. >=Very Good"))
)

estimativas <- predict(modelo3, newdata = novos_dados_media, interval = "confidence")

estimativas
```
Agora, faremos previs√µes pontuais e intervalares para duas observa√ß√µes espec√≠ficas...

```{r}

novos_dados_previsao <- data.frame(
  year = c(2009, 2008),
  age = c(50, 35),
  maritl = factor(c("4. Divorced", "1. Never Married"), 
                  levels = c("1. Never Married", "2. Married", "3. Widowed", "4. Divorced", "5. Separated")),
  education = factor(c("4. College Grad", "2. HS Grad"), 
                     levels = c("1. < HS Grad", "2. HS Grad", "3. Some College", "4. College Grad", "5. Advanced Degree")),
  health = factor(c("2. >=Very Good", "1. <=Good"), 
                  levels = c("1. <=Good", "2. >=Very Good"))
)

previsoes <- predict(modelo3, newdata = novos_dados_previsao, interval = "prediction")

previsoes
```

Conclus√£o de Estima√ß√£o

Primeira Estima√ß√£o:
Estima√ß√£o Pontual (fit): 4.319290
Intervalo de Confian√ßa (lwr, upr): [4.287592, 4.350988]
Interpreta√ß√£o: Para uma combina√ß√£o espec√≠fica de caracter√≠sticas (ano = 2007, idade = 30, estado civil = nunca casado, educa√ß√£o = ensino m√©dio completo, sa√∫de = <=Good), o valor m√©dio esperado de logwage √© 4.319290. Estamos 95% confiantes de que o valor m√©dio verdadeiro de logwage para essa combina√ß√£o de caracter√≠sticas est√° entre 4.287592 e 4.350988.

Segunda Estima√ß√£o:
Estima√ß√£o Pontual (fit): 4.755296
Intervalo de Confian√ßa (lwr, upr): [4.727991, 4.782600]
Interpreta√ß√£o: Para outra combina√ß√£o de caracter√≠sticas (ano = 2008, idade = 45, estado civil = casado, educa√ß√£o =
algum curso superior, sa√∫de = >=Very Good), o valor m√©dio esperado de logwage √© 4.755296. Estamos 95% confiantes de
que o valor m√©dio verdadeiro de logwage para essa combina√ß√£o de caracter√≠sticas est√° entre 4.727991 e 4.782600.

Conclus√£o de Previs√£o

Primeira Previs√£o:
Previs√£o Pontual (fit): 4.792018
Intervalo de Previs√£o (lwr, upr): [4.223358, 5.360677]
Interpreta√ß√£o: Para uma observa√ß√£o espec√≠fica (ano = 2009, idade = 50, estado civil = divorciado, educa√ß√£o =
gradua√ß√£o completa, sa√∫de = >=Very Good), o valor esperado de logwage √© 4.792018. Estamos 95% confiantes de que o
valor verdadeiro de logwage para essa observa√ß√£o estar√° entre 4.223358 e 5.360677. O intervalo de previs√£o √© mais
amplo do que o intervalo de confian√ßa, refletindo a maior incerteza associada a prever um valor individual em vez de
uma m√©dia.

Segunda Previs√£o:
Previs√£o Pontual (fit): 4.348553
Intervalo de Previs√£o (lwr, upr): [3.781000, 4.916107]
Interpreta√ß√£o: Para outra observa√ß√£o espec√≠fica (ano = 2008, idade = 35, estado civil = nunca casado, educa√ß√£o =
ensino m√©dio completo, sa√∫de = <=Good), o valor esperado de logwage √© 4.348553. Estamos 95% confiantes de que o valor
verdadeiro de logwage para essa observa√ß√£o estar√° entre 3.781000 e 4.916107. Novamente, o intervalo de previs√£o √©
mais amplo, refletindo a incerteza na previs√£o de um valor individual.

Por conseguiente...

As estima√ß√µes Pontuais e Intervalares: Fornecem uma faixa de valores esperados para a m√©dia da popula√ß√£o com certas
caracter√≠sticas, com um n√≠vel de confian√ßa de 95%.

E as previs√µes Pontuais e Intervalares: Fornecem uma faixa de valores esperados para observa√ß√µes individuais, com um
n√≠vel de confian√ßa de 95%, mas com maior incerteza devido √† variabilidade individual.



# Modelo 4

```{r}

dados_filtrados_poly <- wage_sem_outliers %>%
  select(-c(region, jobclass, race, health_ins, wage)) %>%
  mutate(age_poly = poly(age, 2, raw = TRUE), 
         year_poly = poly(year, 2, raw = TRUE)) 

```
Ap√≥s a avalia√ß√£o do modelo, observou-se que o coeficiente de determina√ß√£o (
ùëÖ
2
R 
2
 ) foi de 0,32, indicando que aproximadamente 32% da varia√ß√£o no logwage pode ser explicada pelas vari√°veis inclu√≠das.

Al√©m disso, foi observado que o erro residual m√©dio do modelo se estabilizou em 0,083, sugerindo que o modelo est√° realizando previs√µes razo√°veis.
Diante disso, recomenda-se a continuidade da an√°lise, buscando eliminar vari√°veis que possam comprometer as seguintes suposi√ß√µes fundamentais da regress√£o linear.

# Interpreta√ß√µes do modelo selecionado

```{r}
library(report)
report(modelo4_ridge)
```
Fizemos uma an√°lise utilizando um modelo de regress√£o linear regularizado (Ridge) para prever o logaritmo do sal√°rio (logwage) com base nas vari√°veis: ano (year),
idade (age), estado civil (maritl), n√≠vel de escolaridade (education) e sa√∫de (health). O modelo mostra que essas vari√°veis explicam uma parte significativa da varia√ß√£o
no logaritmo do sal√°rio (R¬≤ = 0,34), indicando que cerca de 34% da varia√ß√£o nos sal√°rios pode ser atribu√≠da a essas vari√°veis. A estat√≠stica F do modelo √© alta
(F(11, 2984) = 145,36, p < 0,001), sugerindo que o modelo √© estatisticamente significativo.

Interpreta√ß√£o dos Resultados do Modelo:
Intercepto: O intercepto do modelo √© de -13,39, o que representa o valor estimado do logaritmo do sal√°rio quando todas as vari√°veis independentes s√£o iguais a zero. Embora isso n√£o seja interpret√°vel na pr√°tica, pois uma idade de 0 anos, estado civil "nunca casado",
 escolaridade "menos que o ensino m√©dio" e sa√∫de "ruim" n√£o representam uma situa√ß√£o realista, fornece uma refer√™ncia para o modelo.

Ano (year): A cada ano adicional, o logaritmo do sal√°rio aumenta em m√©dia 0,0058 (ou seja, cerca de 0,58% quando transformado
de logar√≠tmico para o valor original). Isso indica uma tend√™ncia positiva nos sal√°rios ao longo do tempo. O efeito √© estatisticamente significativo (p < 0,001).

Idade (age): A cada ano a mais de idade, o logaritmo do sal√°rio aumenta em m√©dia 0,0099, sugerindo que pessoas mais velhas tendem a ganhar sal√°rios significativamente mais altos.
Este efeito √© estatisticamente significativo (p < 0,001).

Estado Civil (maritl):

Para pessoas casadas, o logaritmo do sal√°rio aumenta em m√©dia 0,1614 em compara√ß√£o aos que nunca foram casados, sendo este efeito estatisticamente significativo (p < 0,001).
As pessoas vi√∫vas t√™m um aumento m√©dio de 0,0425 em rela√ß√£o ao estado civil "nunca casado" (p = 0,65), indicando que esse efeito n√£o √© estatisticamente significativo.
Os divorciados apresentam um aumento m√©dio de 0,0604, enquanto os separados t√™m um aumento m√©dio de 0,1024, ambos em compara√ß√£o aos que nunca foram casados, mas n√£o s√£o estatisticamente significativos.

N√≠vel de Escolaridade (education):

Aqueles com o ensino m√©dio completo t√™m um aumento m√©dio de 0,0558 no logaritmo do sal√°rio, enquanto os que t√™m alguma faculdade apresentam um aumento de 0,1770, e os graduados aumentam em m√©dia 0,2818.
Por fim, aqueles com diploma avan√ßado apresentam um aumento m√©dio de 0,4398. Todos esses efeitos s√£o estatisticamente significativos (p < 0,001).

Sa√∫de (health):

Para aqueles com sa√∫de considerada "muito boa", h√° um aumento m√©dio de 0,0699 no logaritmo do sal√°rio em compara√ß√£o aos que t√™m sa√∫de "ruim",
 sendo este efeito estatisticamente significativo (p < 0,001).

Conclus√£o Pr√°tica:
O Modelo 4, ao incorporar a regulariza√ß√£o Ridge e ajustes polinomiais, demonstrou uma melhoria na capacidade preditiva em rela√ß√£o ao Modelo 3, com um menor erro quadr√°tico m√©dio (0.0824 vs. 0.0832) e um R¬≤ levemente aprimorado,
indicando que as vari√°veis selecionadas fornecem explica√ß√µes mais robustas sobre os sal√°rios em rela√ß√£o ao modelo anterior.

# Previs√µes

Um breve resumo sobre os dados observados:

```{r}
summary(Wage)
```
E agora vamos criar um dataframe para calcular a estima√ß√£o pontual e intervalar para dois valores m√©dios da vari√°vel resposta, a explicativa do nosso modelo...

```{r}

novos_dados_media <- data.frame(
  year = c(2007, 2008),
  age = c(30, 45),
  maritl = factor(c("1. Never Married", "2. Married"), 
                  levels = c("1. Never Married", "2. Married", "3. Widowed", "4. Divorced", "5. Separated")),
  education = factor(c("2. HS Grad", "3. Some College"), 
                     levels = c("1. < HS Grad", "2. HS Grad", "3. Some College", "4. College Grad", "5. Advanced Degree")),
  health = factor(c("1. <=Good", "2. >=Very Good"), 
                  levels = c("1. <=Good", "2. >=Very Good"))
)

estimativas <- predict(modelo4_ridge, newdata = novos_dados_media, interval = "confidence")

estimativas

```

Conclus√£o de Estima√ß√£o
Primeira Estima√ß√£o:

Estima√ß√£o Pontual (fit): 4.319290
Intervalo de Confian√ßa (lwr, upr): [4.287592, 4.350988]
Interpreta√ß√£o: Para uma combina√ß√£o espec√≠fica de caracter√≠sticas (ano = 2007, idade = 30, estado civil = nunca casado, educa√ß√£o = ensino m√©dio completo, sa√∫de = <=Good), o valor m√©dio esperado de logwage √© 4.319290. Estamos 95% confiantes de que o valor m√©dio verdadeiro de logwage para essa combina√ß√£o de caracter√≠sticas est√° entre 4.287592 e 4.350988.
Segunda Estima√ß√£o:

Estima√ß√£o Pontual (fit): 4.755296
Intervalo de Confian√ßa (lwr, upr): [4.727991, 4.782600]
Interpreta√ß√£o: Para outra combina√ß√£o de caracter√≠sticas (ano = 2008, idade = 45, estado civil = casado, educa√ß√£o = algum curso superior, sa√∫de = >=Very Good), o valor m√©dio esperado de logwage √© 4.755296. Estamos 95% confiantes de que o valor m√©dio verdadeiro de logwage para essa combina√ß√£o de caracter√≠sticas est√° entre 4.727991 e 4.782600.


Agora, faremos previs√µes pontuais e intervalares para duas observa√ß√µes espec√≠ficas...

```{r}

novos_dados_previsao <- data.frame(
  year = c(2009, 2008),
  age = c(50, 35),
  maritl = factor(c("4. Divorced", "1. Never Married"), 
                  levels = c("1. Never Married", "2. Married", "3. Widowed", "4. Divorced", "5. Separated")),
  education = factor(c("4. College Grad", "2. HS Grad"), 
                     levels = c("1. < HS Grad", "2. HS Grad", "3. Some College", "4. College Grad", "5. Advanced Degree")),
  health = factor(c("2. >=Very Good", "1. <=Good"), 
                  levels = c("1. <=Good", "2. >=Very Good"))
)

previsoes <- predict(modelo4_ridge, newdata = novos_dados_previsao, interval = "prediction")

previsoes
```

Conclus√£o de Previs√£o
Primeira Previs√£o:

Previs√£o Pontual (fit): 4.792018
Intervalo de Previs√£o (lwr, upr): [4.223358, 5.360677]
Interpreta√ß√£o: Para uma observa√ß√£o espec√≠fica (ano = 2009, idade = 50, estado civil = divorciado, educa√ß√£o = gradua√ß√£o completa, sa√∫de = >=Very Good), o valor esperado de logwage √© 4.792018. Estamos 95% confiantes de que o valor verdadeiro de logwage para essa observa√ß√£o estar√° entre 4.223358 e 5.360677. O intervalo de previs√£o √© mais amplo do que o intervalo de confian√ßa, refletindo a maior incerteza associada a prever um valor individual em vez de uma m√©dia.
Segunda Previs√£o:

Previs√£o Pontual (fit): 4.348553
Intervalo de Previs√£o (lwr, upr): [3.781000, 4.916107]
Interpreta√ß√£o: Para outra observa√ß√£o espec√≠fica (ano = 2008, idade = 35, estado civil = nunca casado, educa√ß√£o = ensino m√©dio completo, sa√∫de = <=Good), o valor esperado de logwage √© 4.348553. Estamos 95% confiantes de que o valor verdadeiro de logwage para essa observa√ß√£o estar√° entre 3.781000 e 4.916107. Novamente, o intervalo de previs√£o √© mais amplo, refletindo a incerteza na previs√£o de um valor individual.
Por conseguinte...
As estima√ß√µes pontuais e intervalares fornecem uma faixa de valores esperados para a m√©dia da popula√ß√£o com certas caracter√≠sticas, com um n√≠vel de confian√ßa de 95%.

As previs√µes pontuais e intervalares fornecem uma faixa de valores esperados para observa√ß√µes individuais, com um n√≠vel de confian√ßa de 95%, mas com maior incerteza devido √† variabilidade individual.

# Conclus√£o e principais resultados do projeto

A an√°lise dos modelos de regress√£o desenvolvidos para prever o sal√°rio (wage) e o logaritmo do sal√°rio (logwage)
oferece uma vis√£o abrangente sobre as vari√°veis que influenciam os rendimentos dos indiv√≠duos na amostra. Segue
uma an√°lise de cada modelo e das melhorias observadas:

1. Modelo de Regress√£o Linear Simples (wage)
O primeiro modelo, que analisa o sal√°rio diretamente, apresentou um R¬≤ ajustado de 0.3361, indicando que
aproximadamente 33,61% da varia√ß√£o no sal√°rio pode ser explicada pelas vari√°veis independentes inclu√≠das. Os
coeficientes significativos, como year e age, mostraram que, para cada ano a mais de experi√™ncia, h√° um aumento
significativo no sal√°rio, enquanto a idade tamb√©m apresenta uma rela√ß√£o positiva. Al√©m disso, o estado civil e o
n√≠vel educacional se destacam, com os casados e aqueles com maior escolaridade apresentando rendimentos mais
elevados.

Os testes de signific√¢ncia revelaram que a maioria das vari√°veis, com exce√ß√£o de algumas categorias de estado civil e
ra√ßa, s√£o estatisticamente significativas (p < 0.05). O erro padr√£o residual foi de 34, sugerindo uma dispers√£o
consider√°vel nos sal√°rios previstos em rela√ß√£o aos sal√°rios reais.

2. Modelo de Regress√£o Logar√≠tmica (logwage)
O segundo modelo, que utiliza a transforma√ß√£o logar√≠tmica do sal√°rio, apresentou uma redu√ß√£o no erro padr√£o residual
para 0.2925 e um R¬≤ ajustado de 0.3084. A transforma√ß√£o logar√≠tmica √© √∫til neste contexto, pois permite uma
interpreta√ß√£o dos coeficientes em termos de percentagens, facilitando a compreens√£o dos efeitos proporcionais das
vari√°veis independentes sobre os sal√°rios.

Os coeficientes do modelo logar√≠tmico mostraram que, ao contr√°rio do modelo original, a interpreta√ß√£o se torna mais
direta: um aumento de um ano na experi√™ncia resulta em um aumento percentual no sal√°rio, assim como o aumento na
idade. As vari√°veis de estado civil e educa√ß√£o mantiveram sua relev√¢ncia, com resultados significativos em todas as
categorias, exceto para os vi√∫vos. Os resultados indicaram que a condi√ß√£o de sa√∫de teve um impacto positivo e
significativo nos sal√°rios.

3. Modelo de Regress√£o Logar√≠tmica Melhorado
O terceiro modelo, semelhante ao segundo, tamb√©m se concentrou na vari√°vel logwage. No entanto, este modelo
apresentou uma leve melhoria em compara√ß√£o ao segundo, com um R¬≤ ajustado de 0.3147 e um erro padr√£o residual de
0.289. A melhoria pode ser atribu√≠da √† inclus√£o de vari√°veis que capturam mais adequadamente a varia√ß√£o no logaritmo
do sal√°rio.

As vari√°veis que mantiveram signific√¢ncia e relev√¢ncia no terceiro modelo foram consistentes com os resultados
anteriores. A interpreta√ß√£o dos coeficientes √© a mesma, mas os resultados mostram que o ajuste adicional ao modelo
melhorou a explica√ß√£o da varia√ß√£o no logwage.

# An√°lise Comparativa e Considera√ß√µes Finais

Comparando os modelos, observa-se que a transforma√ß√£o logar√≠tmica √© ben√©fica para a interpreta√ß√£o dos resultados e
para a redu√ß√£o da variabilidade dos erros. Embora o modelo de sal√°rio direto (modelo 1) tenha um R¬≤ ligeiramente
maior, os modelos logar√≠tmicos oferecem uma perspectiva mais robusta sobre a rela√ß√£o percentual entre as vari√°veis
independentes e os sal√°rios.

Al√©m disso, a an√°lise de VIF n√£o indicou problemas significativos de multicolinearidade, o que √© um sinal positivo
para a confiabilidade dos coeficientes estimados. O uso de m√∫ltiplos modelos para verificar a robustez dos
resultados refor√ßa a import√¢ncia de vari√°veis como educa√ß√£o e estado civil na determina√ß√£o do sal√°rio, sugerindo que
pol√≠ticas voltadas para a educa√ß√£o e a melhoria das condi√ß√µes de trabalho podem ser eficazes na eleva√ß√£o dos
rendimentos.

Em suma, a an√°lise t√©cnica dos modelos de regress√£o sugere que a inclus√£o de vari√°veis que capturam a experi√™ncia, a
educa√ß√£o e a sa√∫de s√£o fundamentais para a compreens√£o da estrutura salarial na amostra estudada, oferecendo insights
valiosos para futuras pesquisas e formula√ß√£o de pol√≠ticas.
